name: Veil â€” Security Baseline Gate (strict)

on:
  pull_request:

permissions:
  contents: read

jobs:
  sbg:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write

    steps:
      - name: Harden runner
        uses: step-security/harden-runner@v2
        with:
          egress-policy: audit

      - name: Checkout
        uses: actions/checkout@v4

      - name: Evaluate Baseline
        uses: actions/github-script@v7
        with:
          script: |
            // Fail PR if baseline checks fail (SECURITY.md, dependabot, etc.)
            // Return non-zero to block merge.

      - name: Sticky PR comment
        if: always()
        uses: marocchino/sticky-pull-request-comment@v2
        with:
          recreate: true
          path: veil-sbg-summary.md
